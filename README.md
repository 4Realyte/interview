# Lazy Init Exception. No Session
В данной ветке проверяется понимание работы кандидата с Hibernate сессиями. Операций Save/Merge

## Этапы проверки
1. Продемонстрировать код приложения
2. Спросить у кандидата, сохранятся ли книги автору
3. Запустить приложение, книги не сохранятся вообще. Вылетит Lazy Init Exception
4. Спросить у кандидата, почему так произошло и как сделать так, чтобы обе книги успешно сохранились

## Ожидаемые ответы
1. Книги не сохранились, так как отсутствовала внешняя транзакция. Сессия после fetch автора закрылась, книги для OneToMany 
по умолчанию в Lazy и не были доступны при вытаскивании из БД
2. Чтобы обе книги сохранились нужно:
   - Пометить метод как **@Transactional**. Однако так как _doInTransaction_ по умолчанию **REQUIRES_NEW**, вызов метода author.addBook()
   в совокупности с методом repository.save(author) вызовут двойной инсерт книги War and Peace, соответственно propagation
   методов нужно также заменить на REQUIRED.
   - Либо не помечать сам метод @Transactional, а в самих doInTransaction присоединять detached автора к текущей сессии с 
помощью merge (save) операции
- Однако это не решает проблемы N + 1. Для этого необходимо переопределить метод репозитория с LEFT JOIN FETCH, EntityGraph 
или EAGER LOADING на OneToMany

## Справочная информация
- При старте приложения добавляется автор с именем "Alexey" и возрастом 45 лет с помощью [файла](./src/main/resources/data.sql)
- Используется in-memory db h2. Консоль для работы с базой доступна по адресу: http://localhost:8080/h2-console, login: sa, 
password: sa
- Open session in view = false
- Код запускается с помощью CommandLineRunner при старте приложения